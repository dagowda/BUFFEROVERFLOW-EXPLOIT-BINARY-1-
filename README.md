# BUFFEROVERFLOW-EXPLOIT-BINARY-1
Identifying the vulnerable code and demonstrating overwriting the return pointer:
• The first step is to download the file and copy it into the VM, and then run the program using gdb or gdb with the pwn debugger.
• The next step is to display all the functions to determine which function contains the vulnerable code.
 
![image](https://user-images.githubusercontent.com/114467712/224256108-97b28e21-df64-46f7-871d-96d14c537606.png)

We could look through all the functions, but we are searching for the particular command in the code that makes the entire code susceptible to buffer overflow. The copyData, checkPassword, and mainframeComputing functions raised the flag.
• I disassembled all the functions. The mainframeComputing function had the gets function, which took the password input after we chose the third option.
• The other two options print certain characters of lines and jump to the line() function and back. So, it is nothing but a loop.
![image](https://user-images.githubusercontent.com/114467712/224256140-03e7c428-923e-4ad1-a805-1ced0f73bad7.png)
 

• In the checkPassword function, the buffer being created was 0x14, which is 20 in decimal. So, if the buffer was 20 and old ebp is 4 bytes, which makes it 24. Anything more than 24 would overflow the return address.
• This time, I ran the program, only inputting 24 characters('A'), and saw where the EIP was. It was at the address 0xffffd05c.
• So, I ran the "i frame" command to see at which address the eip was, like I said before. Then later, I wanted to see the stack, which proved my point.
![image](https://user-images.githubusercontent.com/114467712/224256157-f9f161ea-6936-4796-b4db-b466d22769b0.png)
 

Both the eip address and the value in the address have not yet been over-run, but the previous address, which is the ebp, is 0x41, which is 'A' in character format. Hence there was no error, and after stepping to the next instruction, the program jumped to the main function.
When the input was 25, that was when the return pointer overflowed, and there was a segmentation fault.
![image](https://user-images.githubusercontent.com/114467712/224256173-1de4e13c-86c6-459e-b992-5943c13debf1.png)
 
 
![image](https://user-images.githubusercontent.com/114467712/224256195-ac0e26c0-8789-4215-9613-306b64968b4a.png)
So, I knew the overflow took place after inputting option 3 and then the password, where the offset was 20 and 24, including the ebp.
2. Gaining execution of shellcode
I knew that the shellcode needs to be put in place where the password is inputted, along with the right syntax and NOPs.
• There were a lot of trial and error using various shellcodes.
 
![image](https://user-images.githubusercontent.com/114467712/224256217-f9fb9fae-39b0-478e-967e-d3ceb808f049.png)
This was one of the trial and error executions.
• To obtain the shell, I used a 43-byte long shellcode from shell-storm, which I will post a screenshot of at the bottom.
• To determine the esp value after the entire execution, I used the gdb-peda tool and displayed where the jump call happens of the esp.
![image](https://user-images.githubusercontent.com/114467712/224256240-eb85e956-eced-48d6-96af-028e1cc71a78.png)
 

Any address a little lower than this or an exact address should be fine for the jmpesp to point to in the Python script.

• The Python script and the shellcode are:
![image](https://user-images.githubusercontent.com/114467712/224256268-5a7606b3-970e-4455-89d9-dce907ea09d2.png)
 

• Then, I converted the Python script into a text file.
![image](https://user-images.githubusercontent.com/114467712/224256289-faccbf73-c073-4265-88cb-9431e6bd072c.png)
 

• The command that needs to be run to obtain the shell is:
![image](https://user-images.githubusercontent.com/114467712/224256311-611428bc-4da2-4ccb-8b2d-ac5839b3694a.png)
 

• The final step was to execute the shellcode after the overflow. I used the echo command to input option 3 and then used another echo in the same line to print the Python file, which was converted to a text format.
 
![image](https://user-images.githubusercontent.com/114467712/224256340-44303d72-4885-4036-99bb-db01fd024248.png)
Reference:
SHELLCODE - https://shell-storm.org/shellcode/index.html
Pwndbg extension for KALI- https://github.com/pwndbg/pwndbg
